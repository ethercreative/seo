function createElement(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=document.createElement(e),a=!0,i=!1,s=void 0;try{for(var l,o=Object.entries(t)[Symbol.iterator]();!(a=(l=o.next()).done);a=!0){var c=l.value,d=slicedToArray(c,2),u=d[0],m=d[1];(void 0===m?"undefined":_typeof(m))!==_typeof(function(){})?r.setAttribute(u,m):r.addEventListener(u,m)}}catch(e){i=!0,s=e}finally{try{!a&&o.return&&o.return()}finally{if(i)throw s}}return Array.isArray(n)||(n=[n]),n.map(function(e){try{r.appendChild(e)}catch(t){r.appendChild(document.createTextNode(e))}}),r}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),slicedToArray=function(){function e(e,t){var n=[],r=!0,a=!1,i=void 0;try{for(var s,l=e[Symbol.iterator]();!(r=(s=l.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{!r&&l.return&&l.return()}finally{if(a)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),REDIRECT_TYPES={301:"301 (Permanent)",302:"302 (Temporary)"},Redirects=function(){function e(t,n){var r=this;classCallCheck(this,e),this.onSubmitNew=function(e){e.preventDefault();var t=e.target,n=t.getElementsByClassName("spinner")[0],a=t.elements[r.namespaceField("uri")],i=t.elements[r.namespaceField("to")],s=t.elements[r.namespaceField("type")],l=!0;""===a.value.trim()?(a.classList.add("error"),l=!1):a.classList.remove("error"),""===i.value.trim()?(i.classList.add("error"),l=!1):i.classList.remove("error"),l&&(n.classList.remove("hidden"),r.post("addRedirect",{uri:a.value,to:i.value,type:s.value},function(e){var l=e.id;r.table.appendChild(r.rowStatic(l,a.value,i.value,s.value)),Craft.cp.displayNotice("<strong>SEO:</strong> Redirect added successfully!"),n.classList.add("hidden"),t.reset(),a.focus()},function(e){Craft.cp.displayError("<strong>SEO:</strong> "+e),n.classList.add("hidden")}))},this.onSubmitBulk=function(e){e.preventDefault();var t=e.target,n=t.getElementsByClassName("spinner")[0],a=t.elements[r.namespaceField("redirects")],i=t.elements[r.namespaceField("separator")],s=t.elements[r.namespaceField("type")],l=!0;""===a.value.trim()?(a.classList.add("error"),l=!1):a.classList.remove("error"),""===i.value?(i.classList.add("error"),l=!1):i.classList.remove("error"),l&&(n.classList.remove("hidden"),r.post("bulkAddRedirects",{redirects:a.value,separator:i.value,type:s.value},function(e){e.redirects.forEach(function(e){var t=e.id,n=e.uri,a=e.to,i=e.type;r.table.appendChild(r.rowStatic(t,n,a,i))}),Craft.cp.displayNotice("<strong>SEO:</strong> Redirects added successfully!"),n.classList.add("hidden"),t.reset()},function(e){Craft.cp.displayError("<strong>SEO:</strong> "+e),n.classList.add("hidden")}))},this.onUpdate=function(e){e.preventDefault();var t=e.target,n=t.getElementsByClassName("spinner")[0],a=t.elements[r.namespaceField("id")],i=t.elements[r.namespaceField("uri")],s=t.elements[r.namespaceField("to")],l=t.elements[r.namespaceField("type")],o=!0;""===i.value.trim()?(i.classList.add("error"),o=!1):i.classList.remove("error"),""===s.value.trim()?(s.classList.add("error"),o=!1):s.classList.remove("error"),o&&(n.classList.remove("hidden"),r.post("updateRedirect",{id:a.value,uri:i.value,to:s.value,type:l.value},function(){var e=r.editRow;r.cancelCurrentEdit(),r.table.insertBefore(r.rowStatic(a.value,i.value,s.value,l.value),e),r.table.removeChild(e)},function(e){Craft.cp.displayError("<strong>SEO:</strong> "+e),n.classList.add("hidden")}))},this.onEditClick=function(e,t){e.preventDefault();var n=e.target.dataset,a=n.id,i=n.uri,s=n.to,l=n.type;r.cancelCurrentEdit();var o=r.rowEdit(a,i,s,l);r.editRow=t,r.cancelCurrentEdit=function(){r.table.insertBefore(t,o[0]),r.table.removeChild(o[0]),r.table.removeChild(o[1]),r.cancelCurrentEdit=function(){},r.editRow=null},r.table.insertBefore(o[0],t),r.table.insertBefore(o[1],t),o[0].getElementsByTagName("input")[1].focus(),r.table.removeChild(t)},this.onDeleteClick=function(e,t){e.preventDefault(),confirm("Delete this redirect?")&&r.post("removeRedirect",{id:t.dataset.id},function(){Craft.cp.displayNotice("<strong>SEO:</strong> Redirect deleted"),r.table.removeChild(t)},function(e){Craft.cp.displayNotice("<strong>SEO:</strong> "+e)})},this.ns=t,this.csrf=n,this.table=document.getElementById(t+"-redirectTable"),this.tableForm=document.getElementById(t+"-tableForm"),this.newForm=document.getElementById(t+"-redirectsNew"),this.bulkForm=document.getElementById(t+"-redirectsBulk"),this.cancelCurrentEdit=function(){},this.editRow=null,this.tableForm.addEventListener("submit",this.onUpdate),this.newForm.addEventListener("submit",this.onSubmitNew),this.bulkForm.addEventListener("submit",this.onSubmitBulk),this.initTable()}return createClass(e,[{key:"initTable",value:function(){var e=this;[].slice.call(this.table.getElementsByTagName("tr")).forEach(function(t){var n=t.getElementsByTagName("a");n[0].addEventListener("click",function(n){e.onEditClick(n,t)}),n[1].addEventListener("click",function(n){e.onDeleteClick(n,t)})})}},{key:"namespaceField",value:function(e){return this.ns+"["+e+"]"}},{key:"post",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},a=new FormData;a.append(this.csrf.name,this.csrf.token),a.append("action","seo/redirects/"+e),Object.keys(t).forEach(function(e){t.hasOwnProperty(e)&&a.append(e,t[e])});var i=new XMLHttpRequest;i.open("POST","/",!0),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.onload=function(){var e=i.responseText;i.status>=200&&i.status<400?(e=JSON.parse(e)).hasOwnProperty("success")?n(e):e.hasOwnProperty("error")&&r(_typeof(e.error)===_typeof("")?e.error:e.error[Object.keys(e.error)[0]][0]):r(e)},i.onerror=function(){r("An unknown error has occurred")},i.send(a)}},{key:"rowStatic",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:301,i=createElement("tr",{tabindex:0,"data-id":e},[createElement("td",{class:"redirects--title-col"},[createElement("div",{class:"element small"},[createElement("div",{class:"label"},[createElement("span",{class:"title"},[createElement("a",{href:"#",title:"Edit Redirect","data-id":e,"data-uri":t,"data-to":r,"data-type":a,click:function(e){return n.onEditClick(e,i)}},t)])])])]),createElement("td",{},r),createElement("td",{},REDIRECT_TYPES[a]),createElement("td",{class:"thin action"},[createElement("a",{class:"delete icon",title:"Delete",click:function(e){return n.onDeleteClick(e,i)}})])]);return i}},{key:"rowEdit",value:function(e,t,n,r){var a=this;return[createElement("tr",{class:"redirects--edit-row"},[createElement("td",{},[createElement("input",{value:e,type:"hidden",name:this.namespaceField("id")}),createElement("input",{value:t,type:"text",class:"text fullwidth",name:this.namespaceField("uri")})]),createElement("td",{},[createElement("input",{value:n,type:"text",class:"text fullwidth",name:this.namespaceField("to")})]),createElement("td",{},[createElement("div",{class:"select"},[createElement("select",{name:this.namespaceField("type")},Object.keys(REDIRECT_TYPES).map(function(e){var t={value:e};return r===e&&(t.selected="selected"),createElement("option",t,REDIRECT_TYPES[e])}))])]),createElement("td",{},[createElement("div",{class:"spinner hidden"})])]),createElement("tr",{class:"redirects--edit-controls"},[createElement("td",{colspan:4},[createElement("input",{class:"btn submit",type:"submit",value:"Update"}),createElement("input",{class:"btn",type:"button",value:"Cancel",click:function(){a.cancelCurrentEdit()}})])])]}}]),e}(),SeoSettings=function e(t,n,r){switch(this.namespace=t,this.csrf={name:r[0],token:r[1]},n){case"sitemap":new e.EditableTable(this.namespace+"-customUrls",this.namespace+"-addCustomUrl");break;case"redirects":this.redirectsForm();break;case"settings":this.sitemapName()}};SeoSettings.prototype.sitemapName=function(){var e=document.getElementById(this.namespace+"-sitemapNameExample");document.getElementById(this.namespace+"-sitemapName").addEventListener("input",function(){e.textContent=this.value+".xml"})},SeoSettings.prototype.redirectsForm=function(){new Redirects(this.namespace,this.csrf)},SeoSettings.EditableTable=function(e,t,n){var r=this;this.rowCb="function"==typeof n?n:function(){},this.table=document.getElementById(e).getElementsByTagName("tbody")[0],this.row=this.table.firstElementChild.cloneNode(!0),this.table.firstElementChild.remove(),this.row.classList.remove("hidden"),[].slice.call(this.table.getElementsByClassName("delete")).forEach(function(e){e.addEventListener("click",function(){e.parentNode.parentNode.remove(),r.rowCb()})}),document.getElementById(t).addEventListener("click",function(){r.addRow()})},SeoSettings.EditableTable.prototype.addRow=function(){var e=this,t=this.row.cloneNode(!0);t.innerHTML=t.innerHTML.replace(/{i}/g,this.table.childNodes.length-2),t.getElementsByClassName("delete")[0].addEventListener("click",function(){t.remove(),e.rowCb()}),this.table.appendChild(t),this.rowCb()};
//# sourceMappingURL=seo-settings.min.js.map
